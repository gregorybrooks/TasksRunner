nohup: ignoring input
set -o allexport

DOCKERHUB_USER=gregorybrooks

ENV_FILE=/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/clear_ir.env
source $ENV_FILE
#!/bin/bash
#
# ----- CLEAR IR settings -----
#
# These settings are environment-specific should never need to change:
corpusFileLocation=/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/corpus/
scratchFileLocation=/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/
appFileLocation=/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/app/
isTargetEnglish=false
targetLanguage=ARABIC
corpusFileFormat=BETTER
analyticTasksFileFormat=BETTER
targetCorpusFileName=arabic/arabic-corpus.jl
englishCorpusFileName=english/english-training-corpus.jl
targetIndexName=better-clear-ir-arabic
readQrelFile=true
expandQrelDocuments=false
qrelFileName=IR-relevance-assessments.qrels
tasksFileNameAUTO=ir-automatic-eval-tasks.json
tasksFileNameAUTOHITL=ir-auto-hitl-eval-tasks.json
tasksFileNameHITL=ir-hitl-eval-tasks.json

# These settings control the run, and have been moved to run_settings.env:
##mode=AUTO
##runIndexBuild=false
##runIRPhase1=false
##runIRPhase2=true
##runIRPhase3=false
##doTaskLevelEvaluation=true
##doRequestLevelEvaluation=true
##requestLevelQueryFormulatorDockerImage=gregorybrooks/better-query-builder-1
##taskLevelQueryFormulatorDockerImage=gregorybrooks/better-query-builder-2

CONTROL_FILE=./run_settings_MITRE_EVAL_JAN_2021.env
source $CONTROL_FILE
#!/bin/bash
#
# ----- CLEAR IR settings -----
#
# These settings control the run:

# This can be AUTO, AUTO-HITL, or HITL
mode=HITL

# This step indexes the pre-processed corpus data with Galago.
# No need to do this--it is already included in the Environment.
runIndexBuild=false

# Phase 1 creates the file for the event annotator to find events in the sample docs.
# No need to do this--the annotator was run once and the file was saved in the Docker image.
runIRPhase1=false

# Phase 2 builds the queries, executes them, and evaluates them.
runIRPhase2=true

# Phase 3 calls the re-ranker and builds the final output run file--we skip this for now.
runIRPhase3=false

# Normally this should be TWO_STEP, which means task-level and request-level processing are done separately
processingModel=TWO_STEP

# Do you want task-level evaluations?
doTaskLevelEvaluation=true

# Do you want request-level evaluations?
doRequestLevelEvaluation=true

# In the following 2 settings, put the names of the Docker images to be used to formulate the queries.
# These Docker images must on your machine, already pulled from Docker Hub or created locally.
# Greg's noun phrases approach for task-level:
taskLevelQueryFormulatorDockerImage=gregorybrooks/better-query-builder-2:2.0.0
# Rab's multipartite approach for request-level:
requestLevelQueryFormulatorDockerImage=gregorybrooks/better-query-builder-1:2.0.0

sudoNeeded=true

docker run --rm --env-file=$ENV_FILE --env-file=$CONTROL_FILE -v /var/run/docker.sock:/var/run/docker.sock -v $appFileLocation:$appFileLocation -v $corpusFileLocation:$corpusFileLocation -v $scratchFileLocation:$scratchFileLocation $DOCKERHUB_USER/tasks-runner:2.0.1 bash -c "./runit.sh"
java -jar target/tasks-runner-2.0.1.jar
Skipping phase 1
Skipping phase 3
