nohup: ignoring input
set -o allexport

SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null 2>&1 && pwd )"

# The following file is also passed to the Docker container, so it has to follow
# the rules for Docker env files--no nested variables
ENV_FILE="${SCRIPT_DIR}/eval.env.HITL"
source $ENV_FILE
systemName=PROD
APP_DIR=/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/app
CORPUS_DIR=/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/corpus
SCRATCH_DIR=/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch
targetCorpusFileName=arabic/arabic-corpus.jl
englishCorpusFileName=english/english-training-corpus.jl

preTrainSizeParm=SMALL
skipRequestDocAnnotation=false
skipExampleDocAnnotation=false
skipPretrain=true
skipReranker=true
REQUEST_HITS_DETAILED=50
RESULTS_CAP=50
includeEventsInFinalResults=false
useTaskSetFile=true
processingModel=ONE_STEP
doTaskLevelEvaluation=false
doRequestLevelEvaluation=false
requestLevelQueryFormulatorDockerImage=gregorybrooks/better-query-builder-task-noun-phrases:2.0.0
taskLevelQueryFormulatorDockerImage=gregorybrooks/better-query-builder-task-noun-phrases:2.0.0
getCandidateDocsQueryFormulatorDockerImage=gregorybrooks/better-query-builder-get-candidate-docs:1.0.0
getPhrasesQueryFormulatorDockerImage=gregorybrooks/better-query-builder-get-phrases:1.0.0
rerankerDockerImage=gregorybrooks/better-reranker-z1:3.2.1
sudoNeeded=true
gpuDevice=
isTargetEnglish=false
corpusFileFormat=BETTER
analyticTasksFileFormat=BETTER
readQrelFile=false
expandQrelDocuments=false
qrelFileName=IR-relevance-assessments.qrels
supplementalFileLocation=
supplementalFileName=supplemental_info.json
tasksFileNameAUTO=ir-tasks.json
tasksFileNameAUTOHITL=ir-tasks.json
tasksFileNameHITL=ir-tasks.json
targetLanguage=ARABIC
targetIndexName=better-clear-ir-arabic
englishIndexName=better-clear-ir-english

#docker pull gregorybrooks/tasks-runner:4.1.0
#docker pull gregorybrooks/better-query-builder-task-noun-phrases:2.0.0
#docker pull gregorybrooks/better-query-builder-1:3.1.0
#docker pull gregorybrooks/better-reranker-z1:3.2.1
#docker pull gregorybrooks/better-query-builder-get-candidate-docs:1.0.0

MODELS_BASE_DIR_ENGLISH=
MODELS_BASE_DIR_ARABIC=
#MODELS_BASE_DIR_ARABIC=${SCRATCH_DIR}/clear_ir/isi_models_basic_b_bos

corpusFileLocation=${CORPUS_DIR}
scratchFileLocation=$SCRATCH_DIR/clear_ir
appFileLocation=${APP_DIR}
EVENT_EXTRACTOR_FILE_DIRECTORY=${SCRATCH_DIR}/clear_ir/eventextractorfiles

docker run --rm --env-file=$ENV_FILE -p 9400:9400 -v $PWD:/keystores -v /var/run/docker.sock:/var/run/docker.sock -v $APP_DIR:$APP_DIR -v $CORPUS_DIR:$CORPUS_DIR -v $SCRATCH_DIR:$SCRATCH_DIR --env MODELS_BASE_DIR_ENGLISH=$MODELS_BASE_DIR_ENGLISH --env MODELS_BASE_DIR_ARABIC=$MODELS_BASE_DIR_ARABIC --env corpusFileLocation=$corpusFileLocation --env scratchFileLocation=$scratchFileLocation --env appFileLocation=$appFileLocation --env EVENT_EXTRACTOR_FILE_DIRECTORY=$EVENT_EXTRACTOR_FILE_DIRECTORY --env targetCorpusFileName=$targetCorpusFileName --env englishCorpusFileName=$englishCorpusFileName --entrypoint /home/tasksrunner/scripts/run_ir.sh gregorybrooks/tasks-runner:5.0.0

cd target && java -jar tasks-runner-5.0.0.jar
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/tasksrunner/target/tasks-runner-5.0.0.jar!/BOOT-INF/lib/logback-classic-1.2.10.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/tasksrunner/target/tasks-runner-5.0.0.jar!/BOOT-INF/lib/slf4j-nop-1.7.36.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [ch.qos.logback.classic.util.ContextSelectorStaticBinder]

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::                (v2.6.4)

2022-10-28 16:26:03.188  INFO 7 --- [           main] edu.umass.ciir.TasksRunnerApplication    : Starting TasksRunnerApplication v5.0.0 using Java 11.0.16 on 784f0a72e81c with PID 7 (/home/tasksrunner/target/tasks-runner-5.0.0.jar started by tasksrunner in /home/tasksrunner/target)
2022-10-28 16:26:03.192  INFO 7 --- [           main] edu.umass.ciir.TasksRunnerApplication    : No active profile set, falling back to 1 default profile: "default"
2022-10-28 16:26:04.087  INFO 7 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data MongoDB repositories in DEFAULT mode.
2022-10-28 16:26:04.179  INFO 7 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 86 ms. Found 0 MongoDB repository interfaces.
2022-10-28 16:26:05.064  INFO 7 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 9400 (https)
2022-10-28 16:26:05.077  INFO 7 --- [           main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-10-28 16:26:05.077  INFO 7 --- [           main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.58]
2022-10-28 16:26:05.126  INFO 7 --- [           main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-10-28 16:26:05.126  INFO 7 --- [           main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1842 ms
2022-10-28 16:26:06.954  INFO 7 --- [           main] .s.s.UserDetailsServiceAutoConfiguration : 

Using generated security password: b2173f72-19ee-41dc-b6cd-523d309969ee

2022-10-28 16:26:07.134  INFO 7 --- [           main] o.s.s.w.a.c.ChannelProcessingFilter      : Validated configuration attributes
2022-10-28 16:26:07.188  INFO 7 --- [           main] o.s.s.web.DefaultSecurityFilterChain     : Will not secure any request
2022-10-28 16:26:07.484  WARN 7 --- [           main] o.s.data.convert.CustomConversions       : Registering converter from class java.time.LocalDateTime to class org.joda.time.LocalDateTime as reading converter although it doesn't convert from a store-supported type! You might want to check your annotation setup at the converter implementation.
2022-10-28 16:26:08.437  INFO 7 --- [           main] org.mongodb.driver.cluster               : Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2022-10-28 16:26:08.497  INFO 7 --- [localhost:27017] org.mongodb.driver.cluster               : Exception in monitor thread while connecting to server localhost:27017

com.mongodb.MongoSocketOpenException: Exception opening socket
	at com.mongodb.internal.connection.SocketStream.open(SocketStream.java:70) ~[mongodb-driver-core-4.4.2.jar!/:na]
	at com.mongodb.internal.connection.InternalStreamConnection.open(InternalStreamConnection.java:180) ~[mongodb-driver-core-4.4.2.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.lookupServerDescription(DefaultServerMonitor.java:188) ~[mongodb-driver-core-4.4.2.jar!/:na]
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitorRunnable.run(DefaultServerMonitor.java:152) ~[mongodb-driver-core-4.4.2.jar!/:na]
	at java.base/java.lang.Thread.run(Thread.java:829) ~[na:na]
Caused by: java.net.ConnectException: Connection refused (Connection refused)
	at java.base/java.net.PlainSocketImpl.socketConnect(Native Method) ~[na:na]
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:412) ~[na:na]
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:255) ~[na:na]
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:237) ~[na:na]
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392) ~[na:na]
	at java.base/java.net.Socket.connect(Socket.java:609) ~[na:na]
	at com.mongodb.internal.connection.SocketStreamHelper.initialize(SocketStreamHelper.java:107) ~[mongodb-driver-core-4.4.2.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.initializeSocket(SocketStream.java:79) ~[mongodb-driver-core-4.4.2.jar!/:na]
	at com.mongodb.internal.connection.SocketStream.open(SocketStream.java:65) ~[mongodb-driver-core-4.4.2.jar!/:na]
	... 4 common frames omitted

2022-10-28 16:26:08.517  WARN 7 --- [           main] o.s.data.convert.CustomConversions       : Registering converter from class java.time.LocalDateTime to class org.joda.time.LocalDateTime as reading converter although it doesn't convert from a store-supported type! You might want to check your annotation setup at the converter implementation.
2022-10-28 16:26:09.556  INFO 7 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 9400 (https) with context path ''
2022-10-28 16:26:09.584  INFO 7 --- [           main] edu.umass.ciir.TasksRunnerApplication    : Started TasksRunnerApplication in 6.974 seconds (JVM running for 7.498)
2022-10-28 16:26:32.364  INFO 7 --- [nio-9400-exec-4] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-10-28 16:26:32.365  INFO 7 --- [nio-9400-exec-4] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-10-28 16:26:32.366  INFO 7 --- [nio-9400-exec-4] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
2022-10-28 16:26:32.414  INFO 7 --- [nio-9400-exec-4] TasksRunner                              : GET /search
2022-10-28 16:26:32.421  INFO 7 --- [nio-9400-exec-4] TasksRunner                              : Skipping IE pre-training
2022-10-28 16:26:32.422  INFO 7 --- [nio-9400-exec-4] TasksRunner                              : Target index /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/indexes/better-clear-ir-arabic already exists, so we will NOT build the target index
2022-10-28 16:26:32.422  INFO 7 --- [nio-9400-exec-4] TasksRunner                              : English index /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/indexes/better-clear-ir-english already exists, so we will NOT build the English index
2022-10-28 16:26:32.423  INFO 7 --- [nio-9400-exec-4] TasksRunner                              : Skipping IE pre-training
2022-10-28 16:26:32.424  INFO 7 --- [nio-9400-exec-4] TasksRunner                              : Target index /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/indexes/better-clear-ir-arabic already exists, so we will NOT build the target index
2022-10-28 16:26:32.424  INFO 7 --- [nio-9400-exec-4] TasksRunner                              : English index /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/indexes/better-clear-ir-english already exists, so we will NOT build the English index
2022-10-28 16:26:32.426  INFO 7 --- [nio-9400-exec-4] TasksRunner                              : Executing in HITL mode
2022-10-28 16:26:32.427  INFO 7 --- [nio-9400-exec-4] TasksRunner                              : Opening the analytic task file, expanding example docs
2022-10-28 16:26:32.433  INFO 7 --- [nio-9400-exec-4] TasksRunner                              : Opening task definition file /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/app/ir-tasks.json
2022-10-28 16:26:32.473  INFO 7 --- [nio-9400-exec-4] TasksRunner                              : Reading query file: /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/queryfiles/better.Task.gregorybrooks-better-query-builder-get-phrases:1.0.0.queries.json
2022-10-28 16:26:32.474  INFO 7 --- [nio-9400-exec-4] TasksRunner                              : Reading query file: /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/queryfiles/better.Task.gregorybrooks-better-query-builder-get-phrases:1.0.0.queries.json.NON_TRANSLATED
2022-10-28 16:26:32.477  INFO 7 --- [nio-9400-exec-4] TasksRunner                              : Run file requested does not exist: /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/runfiles/better.Task.gregorybrooks-better-query-builder-get-phrases:1.0.0.out
2022-10-28 16:26:32.478  INFO 7 --- [nio-9400-exec-4] TasksRunner                              : Preparing a file of the example docs for the event annotator
2022-10-28 16:26:32.525  INFO 7 --- [nio-9400-exec-4] TasksRunner                              : Executing this command: cd /home/tasksrunner/scripts &&  sudo MODELS_BASE_DIR_ENGLISH= MODELS_BASE_DIR_FARSI= APP_DIR=/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/app/ MODE=HITL SUBMISSION_ID=better SCRATCH_DIR=/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/ EVENT_EXTRACTOR_FILES_DIRECTORY=/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/eventextractorfiles/ CORPUS_DIR=/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/corpus/ ./annotate_example_docs.sh >& /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/logfiles//annotate_example_docs.better.log
2022-10-28 16:26:32.571  INFO 7 --- [nio-9400-exec-4] TasksRunner                              : annotate_example_docs output:

# Extract events from the example documents

#SINCE NO ONE IS USING THE EVENTS, JUST COPY THE FILE TO THE EXPECTED NAME:
cp ${EVENT_EXTRACTOR_FILES_DIRECTORY}/${MODE}.EXAMPLES.json ${EVENT_EXTRACTOR_FILES_DIRECTORY}/${MODE}.EXAMPLES.json.results.json

#THIS IS WHAT IT WAS WHEN WE WERE CALLING THE EVENT ANNOTATOR:

#cp ${EVENT_EXTRACTOR_FILES_DIRECTORY}/${MODE}.EXAMPLES.json ${APP_DIR}/test_data.bp.json
#cp ${APP_DIR}tasks.json ${APP_DIR}/tasks.json.SAVE
#cp tasks-ie.json ${APP_DIR}/tasks.json

#echo `date`
#MODELS_BASE_DIR=${MODELS_BASE_DIR_ENGLISH} APP_DIR=${APP_DIR} BETTER_PATH=BASIC-E ./run.sh.FARSI

## move the output of the event extractor to where the clear-ir program expects it
#mv ${APP_DIR}/results.json ${EVENT_EXTRACTOR_FILES_DIRECTORY}/${MODE}.EXAMPLES.results.json


#cp ${APP_DIR}/tasks.json.SAVE ${APP_DIR}tasks.json

#echo `date`


2022-10-28 16:26:32.572  INFO 7 --- [nio-9400-exec-4] TasksRunner                              : Retrieving the file of example doc events created by the event annotator
2022-10-28 16:26:32.573 ERROR 7 --- [nio-9400-exec-4] TasksRunner                              : Requested event file /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/eventextractorfiles/better.EXAMPLES.json.results.json does not exist!
2022-10-28 16:26:32.577  INFO 7 --- [nio-9400-exec-4] TasksRunner                              : Writing analytic_tasks.json to /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/eventextractorfiles/better.analytic_tasks.json
2022-10-28 16:26:32.589  INFO 7 --- [nio-9400-exec-4] TasksRunner                              : Building Task-level phrases-to-be-annotated files
2022-10-28 16:26:32.649  INFO 7 --- [nio-9400-exec-4] TasksRunner                              : Executing this command: sudo docker run --rm --env MODE=HITL --env OUT_LANG=ARABIC --env PHASE=Task --env INPUTFILE=better.analytic_tasks.json --env QUERYFILE=better.Task.gregorybrooks-better-query-builder-get-phrases:1.0.0 --env eventExtractorFileLocation=/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/eventextractorfiles/ --env queryFileLocation=/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/queryfiles/ --env logFileLocation=/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/logfiles/ -v /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/eventextractorfiles/:/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/eventextractorfiles/ -v /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/queryfiles/:/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/queryfiles/ -v /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/logfiles/:/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/logfiles/ --env galagoLocation=/home/tasksrunner/galago/bin/ -v /home/tasksrunner/galago:/home/tasksrunner/galago --env englishIndexLocation=/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/indexes/better-clear-ir-english/ -v /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/indexes/better-clear-ir-english:/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/indexes/better-clear-ir-english --env targetIndexLocation=/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/indexes/better-clear-ir-arabic/ -v /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/indexes/better-clear-ir-arabic:/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/indexes/better-clear-ir-arabic --env qrelFile=/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/qrelfiles/IR-relevance-assessments.qrels -v /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/qrelfiles/:/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/qrelfiles/ gregorybrooks/better-query-builder-get-phrases:1.0.0 sh -c ./runit.sh >& /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/logfiles/better.Task.query-formulator.out
2022-10-28 16:26:39.599  INFO 7 --- [nio-9400-exec-4] TasksRunner                              : Docker container output log:
java -jar target/BetterQueryBuilderGetPhrases-1.0.0.jar $eventExtractorFileLocation/$INPUTFILE $MODE $queryFileLocation/$QUERYFILE $OUT_LANG $HOME/programfiles $PHASE $englishIndexLocation $logFileLocation $galagoLocation $qrelFile $targetIndexLocation
0: /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/eventextractorfiles//better.analytic_tasks.json
1: HITL
2: /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/queryfiles//better.Task.gregorybrooks-better-query-builder-get-phrases:1.0.0
3: ARABIC
4: /home/taskquerybuilder/programfiles
5: Task
6: /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/indexes/better-clear-ir-english/
7: /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/logfiles/
8: /home/tasksrunner/galago/bin/
9: /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/qrelfiles/IR-relevance-assessments.qrels
10: /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/indexes/better-clear-ir-arabic/
Program directory: /home/taskquerybuilder/programfiles/ program name: get_noun_phrases_from_spacy_daemon.py
Program directory: /home/taskquerybuilder/programfiles/ program name: get_sentences_from_spacy_daemon.py
set +e
chmod -f a+rw $queryFileLocation/${QUERYFILE}*
exit 0

2022-10-28 16:26:39.600  INFO 7 --- [nio-9400-exec-4] TasksRunner                              : PROCESSING COMPLETE
2022-10-28 16:26:45.406  INFO 7 --- [nio-9400-exec-6] TasksRunner                              : GET /search
2022-10-28 16:26:45.407  INFO 7 --- [nio-9400-exec-6] TasksRunner                              : Skipping IE pre-training
2022-10-28 16:26:45.408  INFO 7 --- [nio-9400-exec-6] TasksRunner                              : Target index /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/indexes/better-clear-ir-arabic already exists, so we will NOT build the target index
2022-10-28 16:26:45.408  INFO 7 --- [nio-9400-exec-6] TasksRunner                              : English index /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/indexes/better-clear-ir-english already exists, so we will NOT build the English index
2022-10-28 16:26:45.409  INFO 7 --- [nio-9400-exec-6] TasksRunner                              : Skipping IE pre-training
2022-10-28 16:26:45.409  INFO 7 --- [nio-9400-exec-6] TasksRunner                              : Target index /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/indexes/better-clear-ir-arabic already exists, so we will NOT build the target index
2022-10-28 16:26:45.409  INFO 7 --- [nio-9400-exec-6] TasksRunner                              : English index /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/indexes/better-clear-ir-english already exists, so we will NOT build the English index
2022-10-28 16:26:45.413  INFO 7 --- [nio-9400-exec-6] TasksRunner                              : Executing in HITL mode
2022-10-28 16:26:45.413  INFO 7 --- [nio-9400-exec-6] TasksRunner                              : Opening the analytic task file, expanding example docs
2022-10-28 16:26:45.414  INFO 7 --- [nio-9400-exec-6] TasksRunner                              : Opening task definition file /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/app/ir-tasks.json
2022-10-28 16:26:45.426  INFO 7 --- [nio-9400-exec-6] TasksRunner                              : Reading query file: /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/queryfiles/better.Task.gregorybrooks-better-query-builder-get-phrases:1.0.0.queries.json
2022-10-28 16:26:45.427  INFO 7 --- [nio-9400-exec-6] TasksRunner                              : Reading query file: /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/queryfiles/better.Task.gregorybrooks-better-query-builder-get-phrases:1.0.0.queries.json.NON_TRANSLATED
2022-10-28 16:26:45.428  INFO 7 --- [nio-9400-exec-6] TasksRunner                              : Run file requested does not exist: /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/runfiles/better.Task.gregorybrooks-better-query-builder-get-phrases:1.0.0.out
2022-10-28 16:26:45.428  INFO 7 --- [nio-9400-exec-6] TasksRunner                              : Preparing a file of the example docs for the event annotator
2022-10-28 16:26:45.433  INFO 7 --- [nio-9400-exec-6] TasksRunner                              : Executing this command: cd /home/tasksrunner/scripts &&  sudo MODELS_BASE_DIR_ENGLISH= MODELS_BASE_DIR_FARSI= APP_DIR=/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/app/ MODE=HITL SUBMISSION_ID=better SCRATCH_DIR=/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/ EVENT_EXTRACTOR_FILES_DIRECTORY=/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/eventextractorfiles/ CORPUS_DIR=/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/corpus/ ./annotate_example_docs.sh >& /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/logfiles//annotate_example_docs.better.log
2022-10-28 16:26:45.468  INFO 7 --- [nio-9400-exec-6] TasksRunner                              : annotate_example_docs output:

# Extract events from the example documents

#SINCE NO ONE IS USING THE EVENTS, JUST COPY THE FILE TO THE EXPECTED NAME:
cp ${EVENT_EXTRACTOR_FILES_DIRECTORY}/${MODE}.EXAMPLES.json ${EVENT_EXTRACTOR_FILES_DIRECTORY}/${MODE}.EXAMPLES.json.results.json

#THIS IS WHAT IT WAS WHEN WE WERE CALLING THE EVENT ANNOTATOR:

#cp ${EVENT_EXTRACTOR_FILES_DIRECTORY}/${MODE}.EXAMPLES.json ${APP_DIR}/test_data.bp.json
#cp ${APP_DIR}tasks.json ${APP_DIR}/tasks.json.SAVE
#cp tasks-ie.json ${APP_DIR}/tasks.json

#echo `date`
#MODELS_BASE_DIR=${MODELS_BASE_DIR_ENGLISH} APP_DIR=${APP_DIR} BETTER_PATH=BASIC-E ./run.sh.FARSI

## move the output of the event extractor to where the clear-ir program expects it
#mv ${APP_DIR}/results.json ${EVENT_EXTRACTOR_FILES_DIRECTORY}/${MODE}.EXAMPLES.results.json


#cp ${APP_DIR}/tasks.json.SAVE ${APP_DIR}tasks.json

#echo `date`


2022-10-28 16:26:45.469  INFO 7 --- [nio-9400-exec-6] TasksRunner                              : Retrieving the file of example doc events created by the event annotator
2022-10-28 16:26:45.470 ERROR 7 --- [nio-9400-exec-6] TasksRunner                              : Requested event file /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/eventextractorfiles/better.EXAMPLES.json.results.json does not exist!
2022-10-28 16:26:45.473  INFO 7 --- [nio-9400-exec-6] TasksRunner                              : Writing analytic_tasks.json to /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/eventextractorfiles/better.analytic_tasks.json
2022-10-28 16:26:45.478  INFO 7 --- [nio-9400-exec-6] TasksRunner                              : Building Task-level phrases-to-be-annotated files
2022-10-28 16:26:45.479  INFO 7 --- [nio-9400-exec-6] TasksRunner                              : Executing this command: sudo docker run --rm --env MODE=HITL --env OUT_LANG=ARABIC --env PHASE=Task --env INPUTFILE=better.analytic_tasks.json --env QUERYFILE=better.Task.gregorybrooks-better-query-builder-get-phrases:1.0.0 --env eventExtractorFileLocation=/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/eventextractorfiles/ --env queryFileLocation=/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/queryfiles/ --env logFileLocation=/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/logfiles/ -v /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/eventextractorfiles/:/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/eventextractorfiles/ -v /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/queryfiles/:/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/queryfiles/ -v /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/logfiles/:/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/logfiles/ --env galagoLocation=/home/tasksrunner/galago/bin/ -v /home/tasksrunner/galago:/home/tasksrunner/galago --env englishIndexLocation=/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/indexes/better-clear-ir-english/ -v /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/indexes/better-clear-ir-english:/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/indexes/better-clear-ir-english --env targetIndexLocation=/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/indexes/better-clear-ir-arabic/ -v /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/indexes/better-clear-ir-arabic:/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/indexes/better-clear-ir-arabic --env qrelFile=/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/qrelfiles/IR-relevance-assessments.qrels -v /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/qrelfiles/:/mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/qrelfiles/ gregorybrooks/better-query-builder-get-phrases:1.0.0 sh -c ./runit.sh >& /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/logfiles/better.Task.query-formulator.out
2022-10-28 16:26:52.196  INFO 7 --- [nio-9400-exec-6] TasksRunner                              : Docker container output log:
java -jar target/BetterQueryBuilderGetPhrases-1.0.0.jar $eventExtractorFileLocation/$INPUTFILE $MODE $queryFileLocation/$QUERYFILE $OUT_LANG $HOME/programfiles $PHASE $englishIndexLocation $logFileLocation $galagoLocation $qrelFile $targetIndexLocation
0: /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/eventextractorfiles//better.analytic_tasks.json
1: HITL
2: /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/queryfiles//better.Task.gregorybrooks-better-query-builder-get-phrases:1.0.0
3: ARABIC
4: /home/taskquerybuilder/programfiles
5: Task
6: /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/indexes/better-clear-ir-english/
7: /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/logfiles/
8: /home/tasksrunner/galago/bin/
9: /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/qrelfiles/IR-relevance-assessments.qrels
10: /mnt/scratch/BETTER/BETTER_TEST_ENVIRONMENTS/BETTER_MITRE_EVAL_JAN_2021/scratch/clear_ir/indexes/better-clear-ir-arabic/
Program directory: /home/taskquerybuilder/programfiles/ program name: get_noun_phrases_from_spacy_daemon.py
Program directory: /home/taskquerybuilder/programfiles/ program name: get_sentences_from_spacy_daemon.py
set +e
chmod -f a+rw $queryFileLocation/${QUERYFILE}*
exit 0

2022-10-28 16:26:52.197  INFO 7 --- [nio-9400-exec-6] TasksRunner                              : PROCESSING COMPLETE
